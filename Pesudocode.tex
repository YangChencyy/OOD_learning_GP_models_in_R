\documentclass{article}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}

\begin{document}

\section*{Gaussian Process Training Algorithm:}

\begin{algorithm}
\caption{Gaussian Process Training Algorithm}
\begin{algorithmic}[1]
\State \textbf{Inputs:}
\State \( D_{\text{train}} \): Training set (InD data)
\State \( D_{\text{test}} \): Testing set (both OOD and InD data)
\State q: Quantile parameter for building threshold
\State
\Procedure{Training}{}
    \State $ModelGP_i \leftarrow \text{fit}(D_{\text{train}}[class_i])  \text{ for all class } i $
    \State $(\textbf{\mu_{cv,i}}, \textbf{\sigma_{cv,i}}) \leftarrow \text{cross validation} \left(ModelGP_i, D_{\text{train}} \right)$
\EndProcedure
\State
\Procedure{Testing}{}
    \State $(\textbf{\mu_{ts,i}}, \textbf{\sigma_{ts,i}}) \leftarrow ModelGP_i(D_{\text{test}} )  \text{ for all class } i$
\EndProcedure
\State
\Procedure{Calculating Score Function}{}
    \Comment{Build threshold based on validation data}
    \State $threshold_i = KL_distance(\textbf{\mu_{cv,i}}, \textbf{\sigma_{cv,i}}) \text{with quantile} q$
    \State
    \Comment{Build threshold based on validation data}
    \State $KLdist_{ts}$
\EndProcedure
\end{algorithmic}
\end{algorithm}



\end{document}
